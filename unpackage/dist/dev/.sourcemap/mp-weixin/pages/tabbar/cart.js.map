{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/liubo1/Desktop/Demo/demo-web/pages/tabbar/cart.vue?b916","webpack:///C:/Users/liubo1/Desktop/Demo/demo-web/pages/tabbar/cart.vue?1346","webpack:///C:/Users/liubo1/Desktop/Demo/demo-web/pages/tabbar/cart.vue?cf1b","webpack:///C:/Users/liubo1/Desktop/Demo/demo-web/pages/tabbar/cart.vue?d46c","uni-app:///pages/tabbar/cart.vue","webpack:///C:/Users/liubo1/Desktop/Demo/demo-web/pages/tabbar/cart.vue?d97e","webpack:///C:/Users/liubo1/Desktop/Demo/demo-web/pages/tabbar/cart.vue?3280"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","computed","data","empty","cartDatas","allChecked","total","watch","onShow","onPullDownRefresh","uni","methods","loadData","goodsTemp","goodsSkuTemp","db","where","field","orderBy","get","then","res","x","callback","tologin","togoods","id","check","item","numberChange","goods_num","cart","deleteCart","title","content","success","_this","clearCart","calcTotal","checked","createOrder","cart_ids","url"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACc;;;AAGjE;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,8LAEN;AACP,KAAK;AACL;AACA,aAAa,4NAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAA8lB,CAAgB,wnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACgFlnB;AAEA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAJA;AACA;AAAA,eAIA;EACAC,4BACA,iCACA;EACAC;IACA;MACA;MACAC;MACA;MACAC;MACA;MACAC;MACA;MACAC;IACA;EACA;EACAC;IACA;IACAH;MACA;MACA;QACA;MACA;IACA;EACA;EACA;EACAI;IACA;EACA;EACA;EACAC;IACA;MACAC;IACA;EACA;EAEAC;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAEA;gBACAC;gBACAC;gBAEAC,8CACAC,gCACAC,MACA,8KACA,CACAC,iCACAC,MACAC;kBACA;oBACA;oBACAC;sBACAC;sBACAA;sBACAA;sBAEA;oBACA;oBACA;oBACA;oBACA;oBACA;oBAEA;sBACA;sBACAC;oBACA;kBACA;gBACA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;QACAC;MACA;IACA;IAEA;IACAC;MACA;QACA;MACA;QACA;QACA;UACAC;QACA;QACA;MACA;MAEA;IACA;IACA;IACAC;MAAA;MACA;MAEA;QACAC;MACA;QACA;UACAC;UACA;UACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACAtB;QACAuB;QACAC;QACAC;UACA;YACAC,4DACAhB;cACA;gBACAgB;cACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA3B;QACAuB;QACAC;QACAC;UACA;YACAC,0DACAhB;cACA;gBACAgB;gBACA;cACA;cACAA;YACA;UACA;QACA;MACA;IACA;IACA;IACAE;MACA;QACA;QACA;MACA;MAEA;QACAC;MAEA;QACA;UACA;UACA;YACAjC;UACA;QACA;UACAiC;QACA;MACA;MAEA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;QACA;UACAC;QACA;MACA;MACA;QACA;QACA;MACA;MACA/B;QACAgC;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrRA;AAAA;AAAA;AAAA;AAAyoC,CAAgB,+mCAAG,EAAC,C;;;;;;;;;;;ACA7pC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/tabbar/cart.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/tabbar/cart.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./cart.vue?vue&type=template&id=3c3dbdc8&\"\nvar renderjs\nimport script from \"./cart.vue?vue&type=script&lang=js&\"\nexport * from \"./cart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cart.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/tabbar/cart.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cart.vue?vue&type=template&id=3c3dbdc8&\"","var components\ntry {\n  components = {\n    useEmpty: function () {\n      return import(\n        /* webpackChunkName: \"components/use-empty/use-empty\" */ \"@/components/use-empty/use-empty.vue\"\n      )\n    },\n    useNumberBox: function () {\n      return import(\n        /* webpackChunkName: \"components/use-number-box/use-number-box\" */ \"@/components/use-number-box/use-number-box.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cart.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"container bg-drak\" :class=\"{ 'margin-bottom-big': !empty }\">\r\n\t\t<!-- 00. 未授权登录 -->\r\n\t\t<use-empty v-if=\"!islogin\" e-style=\"round\" e-type=\"unauthorized\" tip=\"当前未授权\" btn-tip=\"去登录\"\"\r\n\t\t\t:auto=\"false\" @goto=\"tologin\"></use-empty>\r\n\t\t<!-- 00. 空白页 -->\r\n\t\t<use-empty v-else-if=\"empty\" e-style=\"round\" e-type=\"cart\" tip=\"购物车数据为空\"\"></use-empty>\r\n\t\t<!-- 00. 列表 -->\r\n\t\t<view v-else>\r\n\t\t\t<!-- 01. 购物车列表1 -->\r\n\t\t\t<view class=\"cart-list padding-sm\">\r\n\t\t\t\t<block v-for=\"(item, index) in cartDatas\" :key=\"index\">\r\n\t\t\t\t\t<view class=\"cart-item bg-main margin-bottom-sm padding-lg pos-r dflex-s border-radius\">\r\n\t\t\t\t\t\t<view class=\"image-wrapper pos-r\" @click=\"togoods(item)\">\r\n\t\t\t\t\t\t\t<!-- 商品图片 -->\r\n\t\t\t\t\t\t\t<image class=\"border-radius-xs wh-full\" mode=\"aspectFill\" :lazy-load=\"true\"\r\n\t\t\t\t\t\t\t\t:src=\"item.goods.img\">\r\n\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t\t<!-- 选中|未选中按钮 -->\r\n\t\t\t\t\t\t\t<view v-if=\"item.goods.stock_num > 0 && item.goods.stock_num >= item.goods_num\"\r\n\t\t\t\t\t\t\t\tclass=\"iconfont checkbox pos-a bg-main border-radius-big\"\r\n\t\t\t\t\t\t\t\t:class=\"{active: item.checked, iconxuanzhongzhuangtai: item.checked, iconweixuanzhongzhuangtai: !item.checked}\"\r\n\t\t\t\t\t\t\t\t@tap.stop=\"check('item', index)\"></view>\r\n\r\n\t\t\t\t\t\t\t<view v-if=\"(item.goods.stock_num < 10 || item.goods.stock_num < item.goods_num)\"\r\n\t\t\t\t\t\t\t\tclass=\"disabled dflex-c dflex-flow-c pos-a pos-tl-c border-radius-c\">\r\n\t\t\t\t\t\t\t\t<text>库存不足</text><text class=\"margin-left-xs fs-xs\" v-if=\"item.stock_num > 0\">剩余\r\n\t\t\t\t\t\t\t\t\t{{item.goods.stock_num}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"item-right padding-left pos-r\">\r\n\t\t\t\t\t\t\t<!-- 商品名称 -->\r\n\t\t\t\t\t\t\t<view class=\"clamp-2 title\" @click=\"togoods(item)\">{{item.goods.name}}\r\n\t\t\t\t\t\t\t\t{{item.goods.name_pw}}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"ft-dark fs-xs padding-top-xs\">{{ item.goods_sku.spec || '&nbsp;&nbsp;' }}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"padding-tb-sm\">\r\n\t\t\t\t\t\t\t\t<text class=\"price\">{{ item.goods.price / 100 }}</text>\r\n\t\t\t\t\t\t\t\t<text class=\"m-price\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"item.goods.market_price > 0\">{{ item.goods.market_price / 100 }}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<!-- + - 购物车数量 -->\r\n\t\t\t\t\t\t\t<use-number-box :min=\"1\" :max=\"item.goods.stock_num || 1\" :value=\"item.goods_num\"\r\n\t\t\t\t\t\t\t\t:is-max=\"item.goods_num >= item.goods.stock_num\" :is-min=\"item.goods_num === 1\"\r\n\t\t\t\t\t\t\t\t:index=\"index\" :disabled=\"item.goods_num >= item.goods.stock_num\"\r\n\t\t\t\t\t\t\t\t@eventChange=\"numberChange\">\r\n\t\t\t\t\t\t\t</use-number-box>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t<!-- 删除 -->\r\n\t\t\t\t\t\t<view class=\"del-btn iconfont iconlajitong-01 pos-a border-radius-c dflex-c ft-dark fs-xl\"\r\n\t\t\t\t\t\t\t@tap.stop=\"deleteCart(item._id)\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</block>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 02. 底部操作栏 -->\r\n\t\t\t<view class=\"action-section dflex w-full bg-main pos-f padding-right\">\r\n\t\t\t\t<view class=\"checkbox pos-r h-full dflex-c\">\r\n\t\t\t\t\t<view class=\"padding-lr iconfont\"\r\n\t\t\t\t\t\t:class=\"{active:allChecked,iconxuanzhongzhuangtai: allChecked, iconweixuanzhongzhuangtai: !allChecked}\"\r\n\t\t\t\t\t\t@click=\"check('all')\"></view>\r\n\t\t\t\t\t<view class=\"clear-btn pos-a tac ft-white\" :class=\"{ show: allChecked }\" @click=\"clearCart\">清空\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"total-box flex1 tar padding-right-lg\">\r\n\t\t\t\t\t<text class=\"price\">{{total || 0}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<button type=\"primary\" class=\"payment no-border border-radius-lg fs\" @click=\"createOrder\">去结算</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tconst db = uniCloud.database();\r\n\tconst _cart = 'usemall-goods-cart'\r\n\timport {\r\n\t\tmapState\r\n\t} from 'vuex';\r\n\texport default {\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['islogin'])\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// 空白页\r\n\t\t\t\tempty: false,\r\n\t\t\t\t// 购物车数据\r\n\t\t\t\tcartDatas: [],\r\n\t\t\t\t// 全选状态\r\n\t\t\t\tallChecked: false,\r\n\t\t\t\t// 总价格\r\n\t\t\t\ttotal: 0,\r\n\t\t\t};\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\t//显示空白页\r\n\t\t\tcartDatas(e) {\r\n\t\t\t\tlet empty = e.length === 0;\r\n\t\t\t\tif (this.empty !== empty) {\r\n\t\t\t\t\tthis.empty = empty;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 监听页面显示。页面每次出现在屏幕上都触发，包括从下级页面点返回露出当前页面\r\n\t\tonShow() {\r\n\t\t\tthis.loadData();\r\n\t\t},\r\n\t\t// 下拉刷新\r\n\t\tonPullDownRefresh() {\r\n\t\t\tthis.loadData(() => {\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\t\t\t//请求数据\r\n\t\t\tasync loadData(callback) {\r\n\r\n\t\t\t\t// 更改为临时表方式查询\r\n\t\t\t\tconst goodsTemp = db.collection('usemall-goods').getTemp();\r\n\t\t\t\tconst goodsSkuTemp = db.collection('usemall-goods-sku').getTemp();\r\n\r\n\t\t\t\tdb.collection(_cart, goodsTemp, goodsSkuTemp)\r\n\t\t\t\t\t.where('create_uid == $env.uid')\r\n\t\t\t\t\t.field(\r\n\t\t\t\t\t\t'_id, goods_num, goods_sku.spec, goods.price, goods.market_price, goods.stock_num, goods.name,goods.name_pw ,last_modify_time, goods._id as goods_id, goods.img, goods.state'\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.orderBy('last_modify_time desc')\r\n\t\t\t\t\t.get()\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tif (res && res.result && res.result.errCode === 0) {\r\n\t\t\t\t\t\t\tlet _cartDatas = [];\r\n\t\t\t\t\t\t\tres.result.data.forEach(x => {\r\n\t\t\t\t\t\t\t\tx.goods = x.goods[0];\r\n\t\t\t\t\t\t\t\tx.goods_id = x.goods_id[0];\r\n\t\t\t\t\t\t\t\tx.goods_sku = x.goods_sku[0] || {};\r\n\r\n\t\t\t\t\t\t\t\tif (x.goods && x.goods_id) _cartDatas.push(x);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t// 购物车数据\r\n\t\t\t\t\t\t\tthis.cartDatas = _cartDatas;\r\n\t\t\t\t\t\t\t// 计算总价\r\n\t\t\t\t\t\t\tthis.calcTotal();\r\n\r\n\t\t\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\t\t\t// 数据加载完成回调函数\r\n\t\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\treturn;\r\n\t\t\t},\r\n\t\t\t// 跳转登录页\r\n\t\t\ttologin() {\r\n\t\t\t\tthis.$api.tologin();\r\n\t\t\t},\r\n\t\t\t// 跳转商品页\r\n\t\t\ttogoods(item) {\r\n\t\t\t\tthis.$api.togoods({\r\n\t\t\t\t\tid: item.goods_id\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 选中状态处理\r\n\t\t\tcheck(type, index) {\r\n\t\t\t\tif (type === 'item') {\r\n\t\t\t\t\tthis.cartDatas[index].checked = !this.cartDatas[index].checked;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst checked = !this.allChecked\r\n\t\t\t\t\tthis.cartDatas.forEach(item => {\r\n\t\t\t\t\t\titem.checked = checked;\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.allChecked = checked;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.calcTotal();\r\n\t\t\t},\r\n\t\t\t// +- 数量\r\n\t\t\tnumberChange(data) {\r\n\t\t\t\tlet cart = this.cartDatas[data.index];\r\n\r\n\t\t\t\tthis.$db[_cart].update(cart._id, {\r\n\t\t\t\t\tgoods_num: data.number\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tcart.goods_num = data.number;\r\n\t\t\t\t\t\tthis.calcTotal();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$api.msg(res.msg);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 删除\r\n\t\t\tdeleteCart(id) {\r\n\t\t\t\tlet _this = this\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\tcontent: '删除购物车',\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t_this.$db[_cart].where('create_uid == $env.uid').remove(id)\r\n\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t\t\t\t\t_this.loadData();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (res.cancel) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 清空\r\n\t\t\tclearCart() {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\tcontent: '清空购物车',\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t_this.$db[_cart].where('create_uid == $env.uid').remove()\r\n\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\t\t\t\t\t_this.cartDatas = [];\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t_this.$api.msg(res.msg)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else if (res.cancel) {}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 计算总价\r\n\t\t\tcalcTotal() {\r\n\t\t\t\tif (this.cartDatas.length === 0) {\r\n\t\t\t\t\tthis.empty = true;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet total = 0,\r\n\t\t\t\t\tchecked = true;\r\n\r\n\t\t\t\tthis.cartDatas.forEach(item => {\r\n\t\t\t\t\tif (item.checked) {\r\n\t\t\t\t\t\t// 存在库存\r\n\t\t\t\t\t\tif (item.goods.stock_num > 0 && item.goods.stock_num >= item.goods_num) {\r\n\t\t\t\t\t\t\ttotal += (item.goods.price / 100) * item.goods_num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (checked) {\r\n\t\t\t\t\t\tchecked = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tthis.allChecked = checked;\r\n\t\t\t\tthis.total = Number(total.toFixed(2));\r\n\t\t\t},\r\n\t\t\t// 创建订单\r\n\t\t\tcreateOrder() {\r\n\t\t\t\tlet cart_ids = [];\r\n\t\t\t\tthis.cartDatas.forEach(item => {\r\n\t\t\t\t\t// 选中有库存购物车\r\n\t\t\t\t\tif (item.checked && item.goods.stock_num > 0 && item.goods.stock_num > item.goods_num) {\r\n\t\t\t\t\t\tcart_ids.push(item._id)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tif (cart_ids.length <= 0) {\r\n\t\t\t\t\tthis.$api.msg('请选择结算商品')\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/pages/order/create?cart_ids=${cart_ids.join(',')}`\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style lang='scss'>\r\n\tpage {\r\n\t\tmin-height: 100%;\r\n\t}\r\n\r\n\t/* 购物车列表项 */\r\n\t.cart-item {\r\n\r\n\t\t&:last-child {\r\n\t\t\tmargin-bottom: 0;\r\n\t\t}\r\n\r\n\t\t.image-wrapper {\r\n\t\t\twidth: 230rpx;\r\n\t\t\theight: 230rpx;\r\n\t\t\tflex-shrink: 0;\r\n\r\n\t\t\timage {\r\n\t\t\t\topacity: 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.checkbox {\r\n\t\t\ttop: -16rpx;\r\n\t\t\tleft: -16rpx;\r\n\t\t\tcolor: $font-color-disabled;\r\n\t\t\tline-height: 1;\r\n\t\t\tfont-size: 46rpx;\r\n\t\t\tpadding: 5rpx;\r\n\t\t\tz-index: 8;\r\n\t\t}\r\n\r\n\t\t.disabled {\r\n\t\t\tcolor: #fff !important;\r\n\t\t\twidth: 70%;\r\n\t\t\theight: 70%;\r\n\t\t\tbackground-color: rgba(51, 51, 51, 0.5);\r\n\t\t}\r\n\r\n\t\t.item-right {\r\n\t\t\theight: 260rpx;\r\n\t\t\toverflow: hidden;\r\n\t\t}\r\n\r\n\t\t.del-btn {\r\n\t\t\tbottom: 40rpx;\r\n\t\t\tright: 30rpx;\r\n\t\t\twidth: 70rpx;\r\n\t\t\theight: 70rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t/* 底部栏 */\r\n\t.action-section {\r\n\t\tz-index: 999;\r\n\t\tbottom: 0;\r\n\t\theight: 100rpx;\r\n\r\n\t\t.checkbox {\r\n\t\t\t.iconfont {\r\n\t\t\t\tfont-size: 46rpx;\r\n\t\t\t\tcolor: #2C405A;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.clear-btn {\r\n\t\t\tleft: 100rpx;\r\n\t\t\tbackground: #2C405A;\r\n\t\t\tborder-radius: 0 50rpx 50rpx 0;\r\n\t\t\tpadding: 12rpx 0;\r\n\t\t\ttransition: all .2s;\r\n\r\n\t\t\twidth: 0;\r\n\t\t\topacity: 0;\r\n\r\n\t\t\t&.show {\r\n\t\t\t\twidth: 120rpx;\r\n\t\t\t\topacity: 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.payment {\r\n\t\t\tpadding: 0 40rpx;\r\n\t\t\tfont-size: $font-base;\r\n\t\t\tbackground: $uni-color-primary;\r\n\t\t\tbox-shadow: 1px 2px 5px rgba(217, 60, 93, 0.72)\r\n\t\t}\r\n\t}\r\n\r\n\t/* #ifdef H5 || MP-360 */\r\n\t.action-section {\r\n\t\tmargin-bottom: 50px;\r\n\t}\r\n\r\n\t/* #endif */\r\n</style>","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cart.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cart.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1693925694059\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}