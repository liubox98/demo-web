(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-pay-pay"],{"250e":function(t,e,o){"use strict";o("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o("a9e3");var a={props:{timestamp:{type:[Number,String],default:0},autoplay:{type:Boolean,default:!0},separator:{type:String,default:"colon"},separatorSize:{type:[Number,String],default:30},separatorColor:{type:String,default:"#303133"},color:{type:String,default:"#303133"},fontSize:{type:[Number,String],default:30},bgColor:{type:String,default:"#fff"},height:{type:[Number,String],default:"auto"},showBorder:{type:Boolean,default:!1},borderColor:{type:String,default:"#303133"},showSeconds:{type:Boolean,default:!0},showMinutes:{type:Boolean,default:!0},showHours:{type:Boolean,default:!0},showDays:{type:Boolean,default:!0}},watch:{timestamp:function(t,e){clearInterval(this.timer),this.start()}},data:function(){return{d:"00",h:"00",i:"00",s:"00",timer:null,seconds:0}},computed:{itemStyle:function(){var t={};return this.height&&(t.height=this.height+"rpx",t.width=this.height+"rpx"),this.showBorder&&(t.borderStyle="solid",t.borderColor=this.borderColor,t.borderWidth="1px"),this.bgColor&&(t.backgroundColor=this.bgColor),t},letterStyle:function(){var t={};return this.fontSize&&(t.fontSize=this.fontSize+"rpx"),this.color&&(t.color=this.color),t}},mounted:function(){this.autoplay&&this.timestamp&&this.start()},methods:{start:function(){var t=this;this.timestamp<=0||(this.seconds=Number(this.timestamp),this.formatTime(this.seconds),this.timer=setInterval((function(){if(t.seconds--,t.$emit("change",t.seconds),t.seconds<0)return t.end();t.formatTime(t.seconds)}),1e3))},formatTime:function(t){t<=0&&this.end();var e,o=0,a=0,i=0;e=Math.floor(t/86400),o=Math.floor(t/3600)-24*e;var n=null;n=this.showDays?o:Math.floor(t/3600),a=Math.floor(t/60)-60*o-24*e*60,i=Math.floor(t)-24*e*60*60-60*o*60-60*a,o=o<10?"0"+o:o,a=a<10?"0"+a:a,i=i<10?"0"+i:i,this.d=e,this.h=n,this.i=a,this.s=i},end:function(){clearInterval(this.timer),this.timer=null,this.$emit("end",{})}},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}};e.default=a},"3d4f":function(t,e,o){"use strict";o("7a82");var a=o("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(o("5530")),n=a(o("53ca")),s={data:function(){return{money:0,is_submit:1,pay_way:"微信支付",pay_original:"",pay_trade_type:"",pay_tip:"确认支付",qrcode:"",time_remaining:0}},computed:{},onLoad:function(t){var e=this;this.money=t.money/100||0,this.order_id=t.order_id,this.$api.timerout((function(){e.pay_way="微信支付",e.pay_original="微信支付",e.pay_trade_type="NATIVE"}),0),this.pay_tip="已完成支付",this.loadData()},methods:{qrcode_rs:function(t){},loadData:function(){var t=this;t.$func.usemall.call("order/detail",{order_id:t.order_id}).then((function(e){if(200==e.code)return"待付款"===e.datas.order.state?t.is_submit=0:t.pay_tip=t.order_id+" 订单"+e.datas.order.state,t.money=e.datas.order.order_actural_paid/100,t.money<=0?void uni.redirectTo({url:"/pages/pay/success?order_id=".concat(t.order_id)}):void t.loadQRCode();t.$api.msg(e.msg)}))},changePayType:function(t,e,o){this.money<=0||(this.pay_way=t,e&&(this.pay_original=e),o&&(this.pay_trade_type=o),"NATIVE"==this.pay_trade_type&&this.loadQRCode())},confirm:function(){if(!this.is_submit){this.is_submit=1;var t=this;uni.login({success:function(e){if(console.log("loginRes",e),e.code){var o={code:e.code,order_id:t.order_id,pay_way:t.pay_way,pay_original:t.pay_original,pay_trade_type:t.pay_trade_type};t.$func.usemall.call("order/pay",o).then((function(e){if(console.log("支付接口",o,e),200!==e.code)t.$api.timerout((function(){"object"===(0,n.default)(e.msg)&&(e.msg=e.msg.errorMessage),t.$api.msg(e.msg,5e3),t.is_submit=0}),800);else if(e.datas){var a={};uni.canIUse("checkSession")?uni.checkSession({success:function(){t.topayment(a,e.datas.order_id)},fail:function(){uni.login({success:function(){t.topayment(a,e.datas.order_id)},fail:function(){}})}}):t.topayment(a,e.datas.order_id)}else uni.setStorage({key:"__order_state",data:"待付款",success:function(t){console.log(t)},complete:function(){t.$api.toorder()}})}))}},fail:function(e){t.$api.msg(e),t.is_submit=0}})}},topayment:function(t,e){var o=this;uni.requestPayment((0,i.default)((0,i.default)({},t),{},{success:function(t){console.log("requestPayment success:",t),uni.redirectTo({url:"/pages/pay/success?order_id=".concat(e)})},fail:function(t){console.log("requestPayment fail:",t),uni.setStorage({key:"__order_state",data:"待付款",success:function(t){console.log(t)},complete:function(){o.$api.toorder()}})}}))},check:function(){var t=this;t.$func.usemall.call("order/paystate",{order_id:t.order_id}).then((function(e){if(200!=e.code);else{var o=9,a=e.datas.trade_state||"";switch("已付款"==e.datas.pay_state||"SUCCESS"==a?o=0:"NOTPAY"==a||"PAYERROR"==a?o=2:"CLOSED"==a&&(o=3),o){case 0:uni.redirectTo({url:"/pages/pay/success?order_id=".concat(t.order_id)});break;case 1:t.$api.msg("支付超时，请重新支付",3500);break;case 2:t.$api.msg("已取消，请重新支付",3500);break;case 3:t.$api.msg("支付关闭，请重新支付",3500);break;case 4:t.$api.msg("支付取消，请重新支付",3500);break;case 9:default:t.$api.msg("支付失败，请重新支付",3500);break}}})).catch((function(t){}))},loadQRCode:function(){var t=this,e={order_id:t.order_id,pay_way:t.pay_way,pay_original:t.pay_original,pay_trade_type:t.pay_trade_type};uni.showLoading({title:"请求中"}),t.$func.usemall.call("order/pay",e).then((function(o){console.log("支付接口",e),uni.hideLoading(),200!==o.code?t.$api.timerout((function(){t.$api.msg(o.msg,5e3),t.is_submit=0}),800):o.datas?(t.qrcode=o.datas.codeUrl,t.time_remaining=o.datas.time_remaining):uni.setStorage({key:"__order_state",data:"待付款",success:function(t){console.log(t)},complete:function(){t.$api.toorder()}})}))},ontimeend:function(){var t=this;uni.showModal({title:"提示",content:"支付二维码已过期",confirmText:"重新生成",success:function(e){e.confirm?t.loadQRCode():e.cancel&&console.log("用户点击取消")}})}}};e.default=s},"5a05":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return n})),o.d(e,"a",(function(){return a}));var a={useQrcode:o("11f0").default,useCountDown:o("e691").default},i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"app w-full"},[o("v-uni-view",{staticClass:"price-box dflex-c dflex-flow-c"},[o("v-uni-view",[t._v("支付金额")]),o("v-uni-view",{staticClass:"price fs-xxxl margin-top-sm"},[t._v(t._s(t.money))])],1),o("v-uni-view",{staticClass:"pay-type-list"},[o("v-uni-view",{staticClass:"type-item dflex-b pos-r padding-tb-sm",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changePayType("微信支付","微信支付","NATIVE")}}},[o("v-uni-text",{staticClass:"iconfont iconweixin"}),o("v-uni-view",{staticClass:"item flex1"},[o("v-uni-text",{staticClass:"tit"},[t._v("微信支付")]),o("v-uni-text",[t._v("推荐使用 扫一扫 微信支付二维码")])],1),o("v-uni-label",{staticClass:"radio"},[o("v-uni-radio",{attrs:{value:"wxpay",color:"#ff6a6c",colors:"#ff6a6c",checked:"微信支付"==t.pay_way&&"NATIVE"==t.pay_trade_type,disabled:t.money<=0}})],1)],1),o("v-uni-view",{staticClass:"qrcode tac padding-tb"},[o("use-qrcode",{attrs:{onval:!0,val:t.qrcode,qrsize:"200"},on:{result:function(e){arguments[0]=e=t.$handleEvent(e),t.qrcode_rs.apply(void 0,arguments)}}})],1),t.time_remaining?o("v-uni-view",{staticClass:"dflex-c"},[o("use-count-down",{attrs:{"show-days":!1,separator:"zh","separator-color":"#333",color:"#fff","bg-color":"#333","font-size":"24",timestamp:t.time_remaining},on:{end:function(e){arguments[0]=e=t.$handleEvent(e),t.ontimeend.apply(void 0,arguments)}}})],1):t._e()],1),o("v-uni-view",{staticClass:"padding w-full margin-top-big pos-a",staticStyle:{bottom:"30rpx"}},[o("v-uni-view",{staticClass:"dflex-b border-radius-big"},[o("v-uni-view",{staticClass:"tac padding-tb-sm flex1 bg-base",class:1===t.is_submit?"bg-disabled":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.check.apply(void 0,arguments)}}},[t._v(t._s(t.pay_tip))])],1)],1)],1)},n=[]},6928:function(t,e,o){"use strict";var a=o("af55"),i=o.n(a);i.a},"833d":function(t,e,o){"use strict";o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"use-count-down dflex"},[t.showDays?o("v-uni-view",{staticClass:"use-count-down-item dflex-c",style:[t.itemStyle]},[o("v-uni-view",{staticClass:"use-count-down-time",style:[t.letterStyle]},[t._v(t._s(t.d))])],1):t._e(),t.showDays?o("v-uni-view",{staticClass:"use-count-down-colon dflex-c",style:{fontSize:t.separatorSize+"rpx",color:t.separatorColor,paddingBottom:"colon"==t.separator?"4rpx":0}},[t._v(t._s("colon"==t.separator?":":"天"))]):t._e(),t.showHours?o("v-uni-view",{staticClass:"use-count-down-item dflex-c",style:[t.itemStyle]},[o("v-uni-view",{staticClass:"use-count-down-time",style:{fontSize:t.fontSize+"rpx",color:t.color}},[t._v(t._s(t.h))])],1):t._e(),t.showHours?o("v-uni-view",{staticClass:"use-count-down-colon dflex-c",style:{fontSize:t.separatorSize+"rpx",color:t.separatorColor,paddingBottom:"colon"==t.separator?"4rpx":0}},[t._v(t._s("colon"==t.separator?":":"时"))]):t._e(),t.showMinutes?o("v-uni-view",{staticClass:"use-count-down-item dflex-c",style:[t.itemStyle]},[o("v-uni-view",{staticClass:"use-count-down-time",style:{fontSize:t.fontSize+"rpx",color:t.color}},[t._v(t._s(t.i))])],1):t._e(),t.showMinutes?o("v-uni-view",{staticClass:"use-count-down-colon dflex-c",style:{fontSize:t.separatorSize+"rpx",color:t.separatorColor,paddingBottom:"colon"==t.separator?"4rpx":0}},[t._v(t._s("colon"==t.separator?":":"分"))]):t._e(),t.showSeconds?o("v-uni-view",{staticClass:"use-count-down-item dflex-c",style:[t.itemStyle]},[o("v-uni-view",{staticClass:"use-count-down-time",style:{fontSize:t.fontSize+"rpx",color:t.color}},[t._v(t._s(t.s))])],1):t._e(),t.showSeconds&&"zh"==t.separator?o("v-uni-view",{staticClass:"use-count-down-colon dflex-c",style:{fontSize:t.separatorSize+"rpx",color:t.separatorColor,paddingBottom:"colon"==t.separator?"4rpx":0}},[t._v("秒")]):t._e()],1)},i=[]},"8b5a":function(t,e,o){"use strict";o.r(e);var a=o("3d4f"),i=o.n(a);for(var n in a)["default"].indexOf(n)<0&&function(t){o.d(e,t,(function(){return a[t]}))}(n);e["default"]=i.a},"8fcc":function(t,e,o){var a=o("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.price-box[data-v-5cd51c1c]{height:%?266?%;font-size:%?28?%;color:#909399}.pay-type-list[data-v-5cd51c1c]{padding-left:%?60?%;padding-right:%?60?%}.pay-type-list .type-item[data-v-5cd51c1c]{height:%?120?%;font-size:%?30?%}.pay-type-list .iconfont[data-v-5cd51c1c]{width:%?100?%;font-size:%?52?%}.pay-type-list .iconhuiyuan[data-v-5cd51c1c]{color:#fe8e2e}.pay-type-list .iconweixin[data-v-5cd51c1c]{color:#36cb59}.pay-type-list .iconalipay[data-v-5cd51c1c]{color:#01aaef}.pay-type-list .iconqq[data-v-5cd51c1c]{color:#13c6fe}.pay-type-list .iconbaidu[data-v-5cd51c1c]{color:#306cff}.pay-type-list .icontoutiao[data-v-5cd51c1c]{color:#f85959}.pay-type-list .tit[data-v-5cd51c1c]{font-size:%?32?%;color:#303133;margin-bottom:%?4?%}.pay-type-list .item[data-v-5cd51c1c]{display:flex;flex-direction:column;font-size:%?24?%;color:#909399}',""]),t.exports=e},9416:function(t,e,o){"use strict";o.r(e);var a=o("5a05"),i=o("8b5a");for(var n in i)["default"].indexOf(n)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(n);o("c199");var s=o("f0c5"),r=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"5cd51c1c",null,!1,a["a"],void 0);e["default"]=r.exports},af55:function(t,e,o){var a=o("ddbb");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=o("4f06").default;i("4a635199",a,!0,{sourceMap:!1,shadowMode:!1})},b21a:function(t,e,o){"use strict";o.r(e);var a=o("250e"),i=o.n(a);for(var n in a)["default"].indexOf(n)<0&&function(t){o.d(e,t,(function(){return a[t]}))}(n);e["default"]=i.a},b895:function(t,e,o){var a=o("8fcc");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=o("4f06").default;i("58c7db6c",a,!0,{sourceMap:!1,shadowMode:!1})},c199:function(t,e,o){"use strict";var a=o("b895"),i=o.n(a);i.a},ddbb:function(t,e,o){var a=o("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.use-count-down-item[data-v-5e5a90d5]{padding:%?2?%;border-radius:%?6?%;white-space:nowrap;-webkit-transform:translateZ(0);transform:translateZ(0)}.use-count-down-colon[data-v-5e5a90d5]{padding:0 %?5?%;line-height:1;padding-bottom:%?4?%}.use-count-down-scale[data-v-5e5a90d5]{-webkit-transform:scale(.9);transform:scale(.9);-webkit-transform-origin:center center;transform-origin:center center}',""]),t.exports=e},e691:function(t,e,o){"use strict";o.r(e);var a=o("833d"),i=o("b21a");for(var n in i)["default"].indexOf(n)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(n);o("6928");var s=o("f0c5"),r=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"5e5a90d5",null,!1,a["a"],void 0);e["default"]=r.exports}}]);