(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/order/order"],{1839:function(e,t,r){"use strict";(function(e){var o=r("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r("2eee")),a=o(r("448a")),i=o(r("c973")),d=o(r("9523")),c=r("26cb");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var u={data:function(){return{tabCurrentIndex:0,navData:{},navList:[{id:0,state:"全部",loadingType:"more",orderList:[]},{id:1,state:"待付款",loadingType:"more",orderList:[]},{id:2,state:"待发货",loadingType:"more",orderList:[]},{id:3,state:"待收货",loadingType:"more",orderList:[]},{id:4,state:"待评价",loadingType:"more",orderList:[]}],reqdata:{page:1,rows:10},scrollLeft:0,title:"全部"}},watch:{tabCurrentIndex:function(e,t){this.loadData("tab_change",1)}},onShow:function(t){var r=this;if(this.islogin){var o="";e.getStorage({key:"__order_state",success:function(t){o=t.data;var n=r.navList.find((function(e){return e.state==o}));n&&(r.tabCurrentIndex=n.id),e.removeStorage({key:"__order_state"})},complete:function(){r.loadData("refresh")}})}else e.showModal({title:"授权登录",success:function(e){e.confirm?r.$api.tologin():e.cancel&&r.$api.tohome()}})},onLoad:function(t){var r=this;e.$on("__event_order",(function(e){"refresh"==e&&r.loadData("refresh")}))},onPullDownRefresh:function(){this.loadData("refresh")},onReachBottom:function(){this.loadData()},computed:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,d.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},(0,c.mapState)(["islogin"])),methods:{loadData:function(){var t=arguments,r=this;return(0,i.default)(n.default.mark((function o(){var i,d,c;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(i=t.length>0&&void 0!==t[0]?t[0]:"add",d=t.length>1?t[1]:void 0,c=r.navList[r.tabCurrentIndex],r.title=c.state,console.log(r.title),console.log("loadData cur_nav",c),"loading"!==c.loadingType){o.next=8;break}return o.abrupt("return");case 8:if(r.reqdata.state=c.state,1!=d&&"refresh"!=i||(r.reqdata.page=1),i.type&&(i.type=i.type.toLowerCase()),"add"!==i&&"scrolltolower"!=i.type){o.next=17;break}if("nomore"!=c.loadingType){o.next=14;break}return o.abrupt("return");case 14:c.loadingType="loading",o.next=18;break;case 17:c.loadingType="more";case 18:return o.next=20,r.$func.usemall.call("order/list",r.reqdata).then((function(t){if(200===t.code){if(c.loaded=!0,200===t.code)if(1!=d&&"refresh"!=i||(c.orderList=[],c.hasmore=0),t.datas.length>0){var o=[];t.datas.forEach((function(e){o.push(e)})),c.orderList=[].concat((0,a.default)(c.orderList),o),t.datas.length>=r.reqdata.rows?(1==r.reqdata.page&&(c.hasmore=!0),r.reqdata.page++,c.loadingType="more"):c.loadingType="nomore"}else c.loadingType="nomore";1==d?e.hideLoading():"refresh"==i&&e.stopPullDownRefresh(),r.navData=c}}));case 20:case"end":return o.stop()}}),o)})))()},changeTab:function(e){this.tabCurrentIndex=e.target.current},tabClick:function(e){this.tabCurrentIndex=e},todetail:function(t){e.navigateTo({url:"/pages/user/order/order-detail?order_id=".concat(t.order_id)})},payment:function(e){"待核实"!=e.order_pay_state?this.$api.topay({order_id:e.order_id,money:e.order_actural_paid}):this.$api.msg("订单已支付待核实状态")},delOrder:function(t){var r=this;e.showModal({title:"提示",content:"删除订单",success:function(o){o.confirm?(e.showLoading({title:"请稍后"}),r.$func.usemall.call("order/deleted",{order_id:t.order.order_id}).then((function(e){200===e.code&&r.loadData("tab_change",1)}))):o.cancel&&console.log("点击取消")},complete:function(){e.hideLoading()}})},cancelOrder:function(t){var r=this;e.showModal({title:"提示",content:"取消订单",success:function(o){o.confirm?(e.showLoading({title:"请稍后"}),r.$func.usemall.call("order/cancel",{order_id:t.order.order_id,state:"已取消"}).then((function(e){200===e.code&&r.loadData("tab_change",1)}))):o.cancel&&console.log("用户点击取消")},complete:function(){e.hideLoading()}})},toexpress:function(t){e.navigateTo({url:"/pages/user/order/order-express?order_id=".concat(t.order.order_id)})},toreceipt:function(t){var r=this;e.showModal({title:"提示",content:"确认收货",success:function(o){o.confirm?(e.showLoading({title:"请稍后"}),r.$func.usemall.call("order/received",{order_id:t.order.order_id,state:"待评价"}).then((function(e){r.loadData("tab_change",1)}))):o.cancel&&console.log("用户点击取消")},complete:function(){e.hideLoading()}})},torefund:function(t){e.navigateTo({url:"/pages/user/order/order-refund?order_id=".concat(t.order.order_id)})},toevaluate:function(t){e.navigateTo({url:"/pages/user/order/order-evaluate?id=".concat(t.order.order_id)})}}};t.default=u}).call(this,r("543d")["default"])},"1cf0":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o}));var o={useEmpty:function(){return r.e("components/use-empty/use-empty").then(r.bind(null,"fdd1"))},useLoadmore:function(){return r.e("components/use-loadmore/use-loadmore").then(r.bind(null,"9d4a"))}},n=function(){var e=this,t=e.$createElement,r=(e._self._c,e.__map(e.navList,(function(t,r){var o=e.__get_orig(t),n=0===t.orderList.length&&t.loaded,a=e.__map(t.orderList,(function(t,r){var o=e.__get_orig(t),n=!t.order.order_refund_state&&["待收货","待评价","已完成"].includes(t.order.state),a=["已取消","已完成"].includes(t.order.state);return{$orig:o,g1:n,g2:a}})),i=t.orderList.length>0&&t.loaded&&t.hasmore;return{$orig:o,g0:n,l0:a,g3:i}})));e.$mp.data=Object.assign({},{$root:{l1:r}})},a=[]},"240f":function(e,t,r){"use strict";var o=r("7956"),n=r.n(o);n.a},"35e1":function(e,t,r){"use strict";r.r(t);var o=r("1cf0"),n=r("c904");for(var a in n)["default"].indexOf(a)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(a);r("240f");var i=r("f0c5"),d=Object(i["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=d.exports},7956:function(e,t,r){},c5ae:function(e,t,r){"use strict";(function(e,t){var o=r("4ea4");r("cd95"),r("a9ff");o(r("66fd"));var n=o(r("35e1"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(n.default)}).call(this,r("bc2e")["default"],r("543d")["createPage"])},c904:function(e,t,r){"use strict";r.r(t);var o=r("1839"),n=r.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){r.d(t,e,(function(){return o[e]}))}(a);t["default"]=n.a}},[["c5ae","common/runtime","common/vendor"]]]);