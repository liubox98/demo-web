(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/pay/pay"],{"0732":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var r=function(){var e=this.$createElement;this._self._c},n=[]},4121:function(e,t,a){"use strict";var r=a("8196"),n=a.n(r);n.a},7293:function(e,t,a){"use strict";(function(e){var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("9523")),o=r(a("7037"));function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var c={data:function(){return{money:0,is_submit:1,pay_way:"微信支付",pay_original:"",pay_trade_type:"",pay_tip:"确认支付",qrcode:"",time_remaining:0}},computed:{},onLoad:function(e){this.money=e.money/100||0,this.order_id=e.order_id,this.pay_way="微信支付",this.pay_original="微信支付",this.pay_trade_type="JSAPI",this.loadData()},methods:{qrcode_rs:function(e){},loadData:function(){var t=this;t.$func.usemall.call("order/detail",{order_id:t.order_id}).then((function(a){if(200==a.code)return"待付款"===a.datas.order.state?t.is_submit=0:t.pay_tip=t.order_id+" 订单"+a.datas.order.state,t.money=a.datas.order.order_actural_paid/100,t.money<=0?void e.redirectTo({url:"/pages/pay/success?order_id=".concat(t.order_id)}):void 0;t.$api.msg(a.msg)}))},changePayType:function(e,t,a){this.money<=0||(this.pay_way=e,t&&(this.pay_original=t),a&&(this.pay_trade_type=a),"NATIVE"==this.pay_trade_type&&this.loadQRCode())},confirm:function(){if(!this.is_submit){this.is_submit=1;var t=this;e.login({success:function(a){if(console.log("loginRes",a),a.code){var r={code:a.code,order_id:t.order_id,pay_way:t.pay_way,pay_original:t.pay_original,pay_trade_type:t.pay_trade_type};t.$func.usemall.call("order/pay",r).then((function(a){if(console.log("支付接口",r,a),200!==a.code)t.$api.timerout((function(){"object"===(0,o.default)(a.msg)&&(a.msg=a.msg.errorMessage),t.$api.msg(a.msg,5e3),t.is_submit=0}),800);else if(a.datas){var n;n={timeStamp:a.datas.timeStamp,nonceStr:a.datas.nonceStr,package:a.datas.package,signType:a.datas.signType,paySign:a.datas.paySign},e.canIUse("checkSession")?e.checkSession({success:function(){t.topayment(n,a.datas.order_id)},fail:function(){e.login({success:function(){t.topayment(n,a.datas.order_id)},fail:function(){}})}}):t.topayment(n,a.datas.order_id)}else e.setStorage({key:"__order_state",data:"待付款",success:function(e){console.log(e)},complete:function(){t.$api.toorder()}})}))}},fail:function(e){t.$api.msg(e),t.is_submit=0}})}},topayment:function(t,a){var r=this;e.requestPayment(s(s({},t),{},{success:function(t){console.log("requestPayment success:",t),e.redirectTo({url:"/pages/pay/success?order_id=".concat(a)})},fail:function(t){console.log("requestPayment fail:",t),e.setStorage({key:"__order_state",data:"待付款",success:function(e){console.log(e)},complete:function(){r.$api.toorder()}})}}))},check:function(){var t=this;t.$func.usemall.call("order/paystate",{order_id:t.order_id}).then((function(a){if(200!=a.code);else{var r=9,n=a.datas.trade_state||"";switch("已付款"==a.datas.pay_state||"SUCCESS"==n?r=0:"NOTPAY"==n||"PAYERROR"==n?r=2:"CLOSED"==n&&(r=3),r){case 0:e.redirectTo({url:"/pages/pay/success?order_id=".concat(t.order_id)});break;case 1:t.$api.msg("支付超时，请重新支付",3500);break;case 2:t.$api.msg("已取消，请重新支付",3500);break;case 3:t.$api.msg("支付关闭，请重新支付",3500);break;case 4:t.$api.msg("支付取消，请重新支付",3500);break;case 9:default:t.$api.msg("支付失败，请重新支付",3500);break}}})).catch((function(e){}))}}};t.default=c}).call(this,a("543d")["default"])},8196:function(e,t,a){},"8b5a":function(e,t,a){"use strict";a.r(t);var r=a("7293"),n=a.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(o);t["default"]=n.a},"8fdf":function(e,t,a){"use strict";(function(e,t){var r=a("4ea4");a("cd95"),a("a9ff");r(a("66fd"));var n=r(a("9416"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(n.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},9416:function(e,t,a){"use strict";a.r(t);var r=a("0732"),n=a("8b5a");for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);a("4121");var i=a("f0c5"),s=Object(i["a"])(n["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=s.exports}},[["8fdf","common/runtime","common/vendor"]]]);